## 什么是信号？
像人能识别红绿灯一样，红绿灯发出的就是**信号**
- 进程是如何识别信号的？认识+动作
- 进程本身是被程序员填写的属性和逻辑的集合--程序员编码完成
- 当进程收到信号后，进程可能正在执行更为重要的代码，所以不一定会立即处理
- 进程本身必须具有保存信号的能力
- 进程在处理信号的时候，一般有三种动作（默认、自定义、忽略）`这种行为称为 信号被捕捉`
### 发送信号的本质
就是修改PCB中的信号位图\
而只有OS在管理PCB，所以是**OS向目标进程发送信号**\
编号为1 ~ 31的信号为传统UNIX支持的信号，是不可靠信号(非实时的)，编号为32 ~ 63的信号是后来扩充的，称做可靠信号(实时信号)。不可靠信号和可靠信号的区别在于前者不支持排队，可能会造成信号丢失，而后者不会。


ctrl+c热键：OS将其解释为2号信号`2）SIGINT`

## 信号产生
|热键|信号|选项|
|---|---|---|
|ctrl+c|2|SIGINT|
|ctrl+\ |3|SIGQUIT|

2. 系统调用向目标进程发送信号
3. 硬件异常产生信号
4. 软件条件

linux中只允许存在一个前台进程运行
## 函数

|函数名|作用|返回值|头文件|
|---|---|---|---|
|sighandler_t signal(int signum, sighandler_t handler)<br>typedef void (*sighandler_t)(int);|接收信号, 将对应的信号接受的默认动作修改为自定义动作和休眠||#include<signal.h>|
|int kill(pid_t pid, int sig);|接收任意pid, 调用kill对应的参数|成功0失败-1|#include <signal.h>|
|int raise(int sig);|给自己发送任意的信号||#include <signal.h>|
|void abort(void);|给自己发送指定的信号,终止进程||#include <stdlib.h>|
|unsigned int alarm(unsigned int second)|定义的闹钟, 到点发送`SIGALRM 14`信号, 闹钟只会响一次||#include<unistd.h>|
## 信号的含义
信号处理的行为的理解：有很多的情况，进程收到大部分的信号，默认处理动作都是终止进程\
信号的意义：信号的不同，代表不同的事件，但是对事件发生之后的处理动作可以一样

## 除0动作解释
除0会导致OS一直给当前除0进程发送`SIGFPE 8`号信号

OS为什么会知道当前进程产生除0动作？\
CPU中有很多寄存器，存储代码中的变量，并对其进行基本的运算，在CPU中运算时，会有一个**专门检测是否出现错误**的**状态寄存器**

如果产生除0错误，在计算机中除0相当于除无穷小，结果会无穷大。此时会引起状态寄存器中溢出标记位由0设置为1，计算出来的结果没有意义，不需要被采纳。

cpu就会触发运算异常

受到信号，不一定会引起进程退出--没有退出，有可能还会被调到\
CPU内部的寄存器只有一份，但是寄存器中的内容，属于当前进程的上下文!


进程没退出，每次识别到特定信号后跳转执行，进程就会被保存和恢复，所以每次恢复的时候都会让OS识别到了CPU内部的状态寄存器中的溢出标志位是1

## 野指针错误
```cpp
int *p = nullptr;
*p = nullptr;
```
程序中的指针保存的都是虚拟地址

访问nullptr指向的空间时，在页表环节，由于访问0地址，而0地址的内容不允许访问，此时触发了虚拟到物理内存转换的硬件MMU的异常，使得其标志位设置为1，此时硬件的所有异常都会被OS检测到，并且给进程发送信号

## 管道异常
管道读端关闭，写端写入无意义，OS不允许不高效的进程存在，所以给该进程发送`SIGPIPE 13`号信号

## 核心转储
```cpp
int a[10]={0};
a[100]=6;
```
有可能不报错,为什么?\
因为进程有自己的栈帧空间, 只要是在自己的有效空间内访问, 都算是合法访问, 除非访问完全不是该进程的空间。

- Term报错方式表示正常报错，OS不会做额外的操作
- core报错方式会将内存中的有效数据转储到磁盘中

在云服务器上，core是默认关闭的，使用`ulimit -a`查看所有选项\
使用`ulimit -c`设置core存储文件大小

打开后如果触发core报错,OS会将该进程的有效二进制数据存储到以core命名, pid为后缀的文件中。形成一个临时文件

OS将产生崩溃的上下文数据存储起来，方便调试

在gdb中调试使用`core-file core.XXXX`自动跳转到报错行,显示错误信息